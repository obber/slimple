{{!< default}}

{{#post}}
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.15.3/axios.min.js"></script>
<script src="https://code.jquery.com/jquery-3.2.0.slim.min.js"></script>
<article class="post page">

  <header class="post-header page-header">
    {{!-- Page Title --}}
    <h1 class="post-title page-title">{{title}}</h1>
  </header>

  {{!-- Content --}}
  <section class="post-content page-content">
    {{content}}
  </section>

  <form id="contactForm">
    <label for="name">Name:</label>
    <input id="visitorName" type="text" placeholder="Joe Schmidt" required>
    <label for="email">Email:</label>
    <input id="visitorEmail" type="email" placeholder="joe@gmail.com" required>
    <label for="message">Message:</label>
    <textarea id="visitorMessage" name="message" id="message" rows="6" placeholder="Hi, message here...." required></textarea>
    <button id="sendContactForm" type="submit" class="blue">Submit</button>
    </label>
  </form>
  
  {{!--<div id="notification">
    <div class="spinner"></div>
  </div>--}}

  <script>
    (function() {
      var $name = $('#visitorName');
      var $email = $('#visitorEmail');
      var $message = $('#visitorMessage');
      var $form = $('#contactForm');
      var $button = $('#sendContactForm');

      $form.on('submit', function(e) {
        e.preventDefault();

        startSpinner();

        axios.post('http://api.kanadachi.com:9999/contact', {
          name: $name.val(),
          email: $email.val(),
          message: $message.val()
        })
          .then(function(resp) {
            $button.removeClass('gray');
            $button.addClass('green');
            $button.html('Your message was sent.');
            setTimeout(resetForm, 5000);
          })
          .catch(function(err) {
            $button.removeClass('gray');
            $button.addClass('red');
            $button.html('Error! Please find me on social.');
            setTimeout(resetForm, 5000);
          });
      });

      function resetForm() {
        $button.prop('disabled', false);
        $button.removeClass('red green');
        $button.addClass('blue');
        $button.html('Submit');
        $name.val('');
        $email.val('');
        $message.val('');
      }

      function startSpinner() {
        $button.prop('disabled', true);
        $button.removeClass('blue');
        $button.addClass('gray');
        $button.html('<div class="spinner"></div>');
      }

    })();
  </script>

</article>
{{/post}}
